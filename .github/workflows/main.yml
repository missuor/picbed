name: Sync static branch

on:
  push:
    branches:
      - static

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      - name: Check out picbed repository
        uses: actions/checkout@v2
        with:
          repository: missuor/picbed
          ref: static

      - name: Check out notes repository
        uses: actions/checkout@v2
        with:
          repository: missuor/notes
          ref: static
          path: notes

      - name: Sync static branch
        run: |
          cd notes
          git config user.name "${{ github.actor }}"
          git config user.email "${{ github.actor }}@users.noreply.github.com"
          git remote add picbed ../
          git fetch picbed static
          git checkout static
          git merge picbed/static --no-edit
          git push origin static
